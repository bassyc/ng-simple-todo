<!DOCTYPE html>
<html ng-app="todoApp">
<head>
    <title>TODO List</title>
    <link href="../css/bootstrap.css" rel="stylesheet"/>
    <link href="../css/bootstrap-theme.css" rel="stylesheet"/>

    <script src="../scripts/angular.js"></script>

    <script>
       var model = {
        user: "Jignesh",
        items:[
          {
            action: "Buy Flowers", done: false
          },
          {
              action: "Get Shoes", done: false
          },
          {
              action: "Collect Tickets", done: false
          }
        ]
       };

       var todoApp = angular.module("todoApp", []);

       todoApp.controller("ToDoController", function($scope) {
          $scope.todo = model;

          /*
            Controllers define "behaviors" on the scope.

            Behaviors are functions that operate on the data in the model
            to implement the business logic in the application.

            The behaviors defined by a controller support a view to display
            data to the user and to update the model based on user interactions.

            Behaviors are defined by adding functions to the $scope object
            that is passed to the controller function.

            For e.g. the behavior defined below updates the TODO list items
            count in the header, by excluding the completed items count.

            The name of the property used to attach the function to the $scope
            object is used as the behavior name.Our behavior is called
            "incompleteCount", and we can invoke it within the scope of the
            "ng-controller" attribute, which applies the controller to the
            HTML elements that form the view.
          */

          $scope.incompleteCount = function() {
            var count = 0;
            // Here we used angular.forEach method to enumerate the contents
            // of the data array.AngularJS includes some useful utility methods
            // that supplement the Javascript language.
            angular.forEach($scope.todo.items, function(item) {
              if (!item.done) { count++ };
            });
            return count;
          };
       });
    </script>
</head>
<body ng-controller="ToDoController">
    <div class="page-header">
        <h1>
            {{todo.user}}'s To Do List
            <!--
                Notice here that we call the behavior using parentheses.
                You can pass objects are arguments to behaviors, which
                makes it possible to create general-purpose behaviors
                that can be used with different data objects.This present
                application is sufficiently simple that it is not required
                to pass any arguments and instead get the data we require
                directly from the $scope object in the controller.

                Also we have used "ng-hide" directive which will hide the element
                it is applied to - and its content elements - if the expression
                that is assigned as the attribute value evaluates to true
                (boolean).For e.g. if all the items in the TODO list are complete
                then displaying this label to the user doesn't make sense.
            -->
            <span class="label label-default" ng-hide="incompleteCount() == 0">
                {{incompleteCount()}}
            </span>
         </h1>
    </div>

    <div class="panel">
        <div class="input-group">
            <input class="form-control"/>
            <span class="input-group-btn">
                <button class="btn btn-default">Add</button>
            </span>
        </div>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Done</th>
                </tr>
            </thead>

            <tbody>
                <tr ng-repeat="item in todo.items">
                    <td>{{item.action}}</td>
                    <td>
                        <input type="checkbox" ng-model="item.done" />
                    </td>
                    <!--
                          From here we have removed the column displaying
                          true/false values which is no more needed.It was added
                          to demonstrate the two-way binding concept.
                    -->
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>